<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù â€” Ù‚Ø·Ø§Ø¹ Ø§Ù„ÙˆØ³Ø·</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap" rel="stylesheet">
<style>
  :root{--bg1:#f7fbff;--bg2:#eaf3ff;--card:#fff;--border:#e6eef7;--text:#0d1b2a;--muted:#5c6b7a;--brand:#1E88E5;--brand2:#42A5F5;}
  :root[data-theme="dark"]{--bg1:#0e1726;--bg2:#162235;--card:#111827;--border:#213047;--text:#e6edf5;--muted:#a9b8c7;}
  *{box-sizing:border-box} body{margin:0;font-family:'Cairo',system-ui,Arial;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:var(--text);}
  .top-right{position:fixed;right:16px;top:14px;display:flex;align-items:center;gap:8px}
  .theme-btn{width:42px;height:42px;border:none;border-radius:999px;background:linear-gradient(180deg,var(--card),#eef6ff);box-shadow:0 10px 24px rgba(0,0,0,.12);cursor:pointer}
  header{display:flex;justify-content:center;padding:28px 16px 12px}
  .title{font-size:26px;font-weight:900}
  .wrap{max-width:900px;margin:0 auto;padding:12px 16px 36px}
  .tabs{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:12px}
  .tab{border:none;border-radius:12px;color:#fff;background:linear-gradient(135deg,var(--brand),var(--brand2));padding:10px 14px;cursor:pointer;box-shadow:0 10px 24px rgba(30,136,229,.35)}
  .panel{display:none;background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px;box-shadow:0 10px 26px rgba(0,0,0,.08)}
  .panel.active{display:block}
  label{font-weight:800;margin-top:8px;display:block}
  textarea,input[type=text]{width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;background:transparent;color:var(--text)}
  .btn{border:none;border-radius:12px;color:#fff;background:linear-gradient(135deg,var(--brand),var(--brand2));padding:10px 14px;cursor:pointer;box-shadow:0 10px 24px rgba(30,136,229,.35)}
  .toast{position:fixed;right:16px;top:16px;background:#0a7d32;color:#fff;border-radius:12px;padding:10px 14px;display:none}
  .toast.err{background:#c62828}
  #gate{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center}
  #gate .box{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:18px;width:320px;box-shadow:0 10px 26px rgba(0,0,0,.2)}
</style>
</head>
<body>
<div class="top-right">
  <button class="theme-btn" id="themeBtn">ğŸŒ™</button><div style="font-weight:800;color:var(--muted)">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù†Ù…Ø·</div>
</div>
<header><div class="title">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù â€” Ù‚Ø·Ø§Ø¹ Ø§Ù„ÙˆØ³Ø·</div></header>
<div class="wrap" id="content" style="display:none">
  <div class="tabs">
    <button class="tab" onclick="openTab('ads',this)">Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</button>
    <button class="tab" onclick="openTab('honor',this)">Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù</button>
    <button class="tab" onclick="openTab('links',this)">Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</button>
  </div>

  <section id="ads" class="panel active">
    <label>Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</label>
    <textarea id="adText" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù‡Ù†Ø§..."></textarea>
    <div style="margin-top:10px"><button class="btn" onclick="sendAd()">Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</button></div>
  </section>

  <section id="honor" class="panel">
    <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙƒØ²</label><input id="center" type="text" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø±ÙƒØ² Ø§Ù„ÙˆØ³Ø·">
    <label>Ø§Ø³Ù… Ø§Ù„ÙØ±Ù‚Ø©</label><input id="team" type="text" placeholder="Ù…Ø«Ø§Ù„: ÙØ±Ù‚Ø© Ø§Ù„ØµÙ‚ÙˆØ±">
    <label>Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ (ÙƒÙ„ Ø§Ø³Ù… ÙÙŠ Ø³Ø·Ø±)</label><textarea id="members" placeholder="Ù…Ø­Ù…Ø¯\nØ®Ø§Ù„Ø¯\nØ¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ²"></textarea>
    <div style="margin-top:10px"><button class="btn" onclick="sendHonor()">Ø­ÙØ¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù</button></div>
  </section>

  <section id="links" class="panel">
    <label>Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù‚Ø·Ø§Ø¹</label><input id="lnkTable" type="text" placeholder="https://...">
    <label>Ø±Ø§Ø¨Ø· Ø­Ø¬Ø² Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª</label><input id="lnkVacation" type="text" placeholder="https://...">
    <label>Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ´ÙŠÙŠÙƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ</label><input id="lnkCheck" type="text" placeholder="https://...">
    <label>Ø±Ø§Ø¨Ø· ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø§Øª</label><input id="lnkSwap" type="text" placeholder="https://...">
    <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</label><input id="lnkSuggest" type="text" placeholder="https://...">
    <div style="margin-top:10px"><button class="btn" onclick="saveLinks()">Ø­ÙØ¸ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</button></div>
  </section>
</div>

<div id="gate">
  <div class="box">
    <div style="font-weight:800;margin-bottom:8px">ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø´Ø±Ù</div>
    <input type="password" id="pwd" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:10px">
    <div style="display:flex;gap:8px;margin-top:10px">
      <button class="btn" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
      <button class="btn" onclick="document.getElementById('pwd').value=''">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
    <div id="msg" style="color:#c62828;margin-top:8px;display:none">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©</div>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
const SCRIPT_URL = "https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhjIuIVFchcROlTw9O9VFWnnCntkcZbqTknAwetnlnj4LpMrMHfAnLvDqJ6q27gEKRFVO9mKIYjXC6Et7nM1Bbx5xiCeINCf3DdaZmnLkvmgPtjpFvelCie4K0C6vBEl7Vb_EmjGt5p2EbUR0pcp6Mr4Qh0VNQjvVqJA66EQpNO1xi_cDbGyAP3BF5ls5uKmiguzKes_BU3goh9Fnf1QNNzTDf2Wk7Maz7cqJOPcVAzzMMO2hXMGJ4DNm2GiNKt-X3v7XZZ4HtSPm87UacQ4hRohO2Rs_hSNdDidiwy&lib=M6dwE7UlaQmbBMEakihoL5071_fspkL81";

const root = document.documentElement;
const saved = localStorage.getItem('theme') || 'light';
if(saved==='dark'){ root.setAttribute('data-theme','dark'); document.getElementById('themeBtn').textContent='â˜€ï¸'; }
document.getElementById('themeBtn').onclick = ()=>{
  const dark = root.getAttribute('data-theme')==='dark';
  root.setAttribute('data-theme', dark?'light':'dark');
  localStorage.setItem('theme', dark?'light':'dark');
  document.getElementById('themeBtn').textContent = dark?'ğŸŒ™':'â˜€ï¸';
};

function toast(msg,err){const t=document.getElementById('toast');t.textContent=msg;t.className='toast'+(err?' err':'');t.style.display='block';setTimeout(()=>t.style.display='none',2500);}
function openTab(id,btn){document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));document.getElementById(id).classList.add('active');}
function login(){const v=document.getElementById('pwd').value; if(v==='admin3838771'){document.getElementById('gate').style.display='none'; document.getElementById('content').style.display='block';} else {document.getElementById('msg').style.display='block';}}

async function postJSON(payload){
  try{
    const r=await fetch(SCRIPT_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
    const ct=r.headers.get('content-type')||''; let data=null;
    if(ct.includes('application/json')) data=await r.json(); else data={};
    if((data.status && data.status==='success') || data.ok===true) return true;
    console.log('RESP',data); return false;
  }catch(e){console.error(e); return false;}
}

function sendAd(){
  const text = document.getElementById('adText').value.trim();
  if(!text) return toast('Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø£ÙˆÙ„Ø§Ù‹',true);
  if(!confirm('ØªØ£ÙƒÙŠØ¯ Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ')) return;
  postJSON({sheet:'Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª', title:'', text}).then(s=>{ if(s){toast('ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ…'); document.getElementById('adText').value='';} else toast('Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„',true); });
}

function sendHonor(){
  const center=document.getElementById('center').value.trim();
  const team=document.getElementById('team').value.trim();
  const members=document.getElementById('members').value.split('\\n').map(s=>s.trim()).filter(Boolean);
  if(!center||!team||!members.length) return toast('Ø£ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„',true);
  if(!confirm('ØªØ£ÙƒÙŠØ¯ Ø­ÙØ¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±ÙØŸ')) return;
  postJSON({sheet:'Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù', center, team, members}).then(s=>{ toast(s?'ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ…':'Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„',!s); });
}

function saveLinks(){
  const table=document.getElementById('lnkTable').value.trim();
  const vacation=document.getElementById('lnkVacation').value.trim();
  const check=document.getElementById('lnkCheck').value.trim();
  const swap=document.getElementById('lnkSwap').value.trim();
  const suggestions=document.getElementById('lnkSuggest').value.trim();
  if(!confirm('ØªØ£ÙƒÙŠØ¯ Ø­ÙØ¸ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·ØŸ')) return;
  postJSON({sheet:'Ø§Ù„Ø±ÙˆØ§Ø¨Ø·', table, vacation, check, swap, suggestions}).then(s=>{ toast(s?'ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ…':'Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„',!s); });
}
</script>
</body>
</html>
